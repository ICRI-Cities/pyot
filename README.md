# PyoT
## The Python-base Framework for IoT Nodes
PyoT provides a convient and robust framework for implementing software/firmware on Intel IoT Nodes. Using a system of breaking down an IoT Node's hardware into a conceptual hierarchy, PyoT enables new node configurations to be added quickly and easily. This allows data from sensors to be collected and pushed to backend data stores automatically from the configuration.

## PyoT's Hierarchy
PyoT views any IoT Node as a tree of peripherals, starting with the root peripherals, or platform. From there, a number of
peripherals are children of the platform, each containing endpoints (discussed below) and possibly more peripherals as children of their own. The platform (or parent peripheral) provides the various interfaces contained within the hardware as software ports, enabling other peripherals to connect to it. For example, the Intel Galileo platform provides a number of GPIO ports, some AIN ports, two UART ports, one SPI and one I2C ports for other peripherals to connect to. The connections are determined at runtime by the configuration file.

Most peripherals also provide various endpoints which can be access. These include the ports mentioned above, as well as any sensors or actuators that are part of that peripheral. Endpoints are also and comm link between the node and a backend. These endpoints give the peripheral actual functionality, with ports, sensors, actuators and comm each having a rigidly defined API for other peripherals to interact through.

Connections and references to the various peripherals and endpoints is achieved with a simple Unix-like file structure. For instance, if there were a peripheral with the name 'p1' with a sensor endpoint 'temperature' that is an immediate child to the platform name 'myPlatform', the object reference to the sensor endpoint would be '/myPlatform/p1:temperature'. This format enables the use of '.' and '..' in code and the configuration file to reference the peripheral and the parent peripheral respectively without having to know the full path. For instance, a common parameter needed by sensors on a child peripheral is the port to which they are connected on the parent. As such, the reference '../.:port_name' can be used to connect to that port without needing to know the parents name or full path (Note that '..:port_name' is not accepted, you must include at least one '/' to reference a peripheral to which you are not a member).

## Abstraction Construction
At startup, PyoT will examine the configuration file and construct the software hierarchy defined. This begins with the platform and recursively through all the peripherals via their `create` method. Once this completes, all the peripheral objects are created. In order to create endpoints for each of these peripherals, the next phase of the abstraction construction is the build phase. In this phase, the `build` method of all peripherals is called. Here, endpoints as added to the peripherals `endpoints` object, via the `add` method on the endpoints object. Then, the `build` method for all the added endpoints is called.

The next phase is the connect phase, in which the `connect` method is called for each peripheral and their endpoints. This phase is intended for peripherals and endpoints gathering any references needed to operate, such as references to their parent's ports to interact with in later methods.

The final phase is the init phase, in which the `init` method is called for each peripheral and their endpoints. Here, any kind of initialization is preformed, whether its interfacing through the ports established in the connect phase to physical hardware and setting it up, or creating a communications link to a backend.

Each of these methods takes in a dictionary of parameters that are taken from the configuration file. This allows each module in the system to take in whatever special parameters they need in a portable way. For example, a communication endpoint might be the URL and port of its backend in the init phase while a sensor might need a reference to the specific port to connect to in the connect phase.

Once all of these phases completes, the PyoT framework is ready to being reading from sensors and sending data to the backend.